<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Pro - Digital Shop</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap');
        
        :root {
            --primary: #2563eb;
            --bkash: #e2136e;
            --nagad: #ed1c24;
            --bg: #f8fafc;
        }

        body { 
            background-color: var(--bg); 
            font-family: 'Plus Jakarta Sans', sans-serif;
            margin: 0; padding: 0;
        }

        .page { padding: 16px; padding-bottom: 110px; }
        .hidden { display: none; }

        /* Navigation */
        .bottom-nav { 
            background: white; border-top: 1px solid #f1f5f9; 
            position: fixed; bottom: 0; left: 0; right: 0; 
            display: flex; justify-content: space-around; 
            padding: 12px 0; z-index: 100;
        }
        .nav-item { border:none; background:none; display: flex; flex-direction: column; align-items: center; font-size: 11px; color: #94a3b8; font-weight: 700; transition: 0.3s; }
        .nav-item.active { color: var(--primary); }
        .nav-item i { font-size: 22px; margin-bottom: 4px; }

        /* Wallet Card Design */
        .wallet-card {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border-radius: 30px; padding: 30px; position: relative; overflow: hidden; color: white;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .wallet-card::before {
            content: ''; position: absolute; top: -50px; right: -50px; width: 150px; height: 150px;
            background: rgba(255,255,255,0.05); border-radius: 50%;
        }

        /* VPN Card */
        .vpn-card {
            background: white; border-radius: 20px; overflow: hidden; border: 1px solid #f1f5f9;
            transition: 0.3s;
        }
        .vpn-card:active { transform: scale(0.97); }

        /* Payment Gateway */
        #view-gateway { position: fixed; inset: 0; background: white; z-index: 2000; overflow-y: auto; }
        .gateway-footer { border-radius: 40px 40px 0 0; padding: 30px 20px; min-height: 70vh; }
        
        .method-toggle { display: inline-flex; background: #f1f5f9; padding: 4px; border-radius: 50px; }
        .toggle-btn { padding: 8px 24px; border-radius: 50px; font-weight: 800; cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 14px; }
        .toggle-btn.active { background: white; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }

        .similar-scroll::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>

    <!-- App Header -->
    <header id="main-header" class="p-4 flex justify-between items-center bg-white border-b">
        <div class="flex items-center gap-3">
            <img id="profile-pic" src="https://ui-avatars.com/api/?name=User" class="w-10 h-10 rounded-full border-2 border-blue-500">
            <div>
                <p class="text-[10px] font-bold text-slate-400 uppercase leading-none">Welcome back,</p>
                <h1 id="user-display-name" class="font-bold text-slate-800">User</h1>
            </div>
        </div>
        <div class="bg-blue-50 px-4 py-1.5 rounded-full border border-blue-100">
            <p id="balance-top" class="text-sm font-black text-blue-600">‡ß≥0.00</p>
        </div>
    </header>

    <main>
        <!-- Home View -->
        <div id="view-home" class="page">
            <div class="mb-6 rounded-3xl overflow-hidden shadow-lg">
                <img src="https://img.freepik.com/free-vector/special-offer-modern-banner-design_1017-15072.jpg" class="w-full">
            </div>
            <h2 class="text-lg font-black mb-4">Featured Services</h2>
            <div id="product-grid" class="grid grid-cols-2 gap-4"></div>
        </div>

        <!-- VPN Page -->
        <div id="view-vpn" class="page hidden">
            <h2 class="text-xl font-black mb-4">All VPN Services</h2>
            <div id="vpn-grid" class="grid grid-cols-1 gap-4"></div>
        </div>

        <!-- VPN Detail View (Full Page) -->
        <div id="view-vpn-details" class="page hidden bg-white fixed inset-0 z-[150] overflow-y-auto pb-10">
            <button onclick="navigate('vpn')" class="absolute top-6 left-6 w-10 h-10 bg-white rounded-full shadow-lg flex items-center justify-center z-10">
                <i class="fas fa-chevron-left"></i>
            </button>
            <div id="vpn-details-content"></div>
            
            <div class="px-4 mt-8">
                <h3 class="font-bold text-slate-800 mb-4">Similar Products</h3>
                <div id="similar-products" class="flex gap-4 overflow-x-auto similar-scroll pb-4"></div>
            </div>
        </div>

        <!-- Email View -->
        <div id="view-email" class="page hidden">
            <div class="bg-white rounded-3xl p-6 shadow-sm border">
                <h2 class="text-xl font-black mb-6">Buy Accounts</h2>
                <div class="space-y-4">
                    <label class="text-xs font-bold text-slate-400 uppercase ml-1">Choose Platform</label>
                    <select id="email-select" onchange="syncEmail()" class="w-full p-4 bg-slate-50 border-none rounded-2xl font-bold outline-none ring-1 ring-slate-100">
                        <option value="gmail">Gmail Premium</option>
                        <option value="hotmail">Hotmail Fresh</option>
                        <option value="outlook">Outlook Business</option>
                        <option value="edu">Edu Mail (Lifetime)</option>
                        <option value="proton">Proton Mail</option>
                    </select>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-blue-50 p-4 rounded-2xl text-center">
                            <p class="text-[10px] font-bold text-blue-400">PRICE</p>
                            <p class="text-lg font-black text-blue-700">‡ß≥<span id="em-price">25</span></p>
                        </div>
                        <div class="bg-slate-50 p-4 rounded-2xl text-center">
                            <p class="text-[10px] font-bold text-slate-400">STOCK</p>
                            <p class="text-lg font-black text-slate-700"><span id="em-stock">99</span></p>
                        </div>
                    </div>
                    <input type="number" id="em-qty" value="1" min="1" oninput="calcTotal()" class="w-full p-4 bg-slate-100 rounded-2xl font-black text-center text-xl" placeholder="Quantity">
                    <button onclick="handlePurchase('email')" class="w-full bg-slate-900 text-white py-4 rounded-2xl font-bold shadow-xl">BUY NOW (‡ß≥<span id="em-total">25</span>)</button>
                </div>
            </div>
        </div>

        <!-- Wallet View -->
        <div id="view-wallet" class="page hidden">
            <div class="wallet-card mb-8">
                <div class="flex justify-between items-start">
                    <div>
                        <p class="text-xs font-bold opacity-60 uppercase tracking-widest">Available Balance</p>
                        <h2 class="text-4xl font-black mt-2">‡ß≥<span id="wallet-balance-val">0.00</span></h2>
                    </div>
                    <div class="bg-white/10 p-3 rounded-2xl">
                        <i class="fas fa-wallet text-2xl"></i>
                    </div>
                </div>
                <div class="mt-8 flex items-center gap-2">
                    <div class="h-1.5 flex-1 bg-white/10 rounded-full overflow-hidden">
                        <div class="h-full bg-blue-400 w-1/2"></div>
                    </div>
                    <p class="text-[10px] font-bold opacity-60">Verified Account</p>
                </div>
            </div>

            <h3 class="font-extrabold text-slate-800 mb-4">Fast Deposit</h3>
            <div class="grid grid-cols-2 gap-4">
                <button onclick="openGateway('bkash')" class="bg-white p-5 rounded-3xl border flex flex-col items-center gap-3">
                    <img src="bkash.jpg" class="h-10 w-10 rounded-full object-cover border" onerror="this.src='https://searchvectorlogo.com/wp-content/uploads/2020/02/bkash-logo-vector.png'">
                    <span class="font-bold text-sm">bKash</span>
                </button>
                <button onclick="openGateway('nagad')" class="bg-white p-5 rounded-3xl border flex flex-col items-center gap-3">
                    <img src="nagad.jpg" class="h-10 w-10 rounded-full object-cover border" onerror="this.src='https://upload.wikimedia.org/wikipedia/commons/thumb/8/8e/Nagad_Logo.svg/1200px-Nagad_Logo.svg.png'">
                    <span class="font-bold text-sm">Nagad</span>
                </button>
            </div>
        </div>

        <!-- Admin View -->
        <div id="view-admin" class="page hidden">
            <h2 class="text-xl font-black text-red-600 mb-4">Admin Inventory</h2>
            <div id="admin-inventory" class="space-y-2"></div>
        </div>

        <!-- Payment Gateway -->
        <div id="view-gateway" class="hidden">
            <div class="p-6 text-center">
                <button onclick="closeGateway()" class="absolute left-6 top-8 text-slate-400"><i class="fas fa-arrow-left text-xl"></i></button>
                <img id="gateway-logo" src="" class="h-10 mx-auto mt-2">
                
                <div class="method-toggle mt-8">
                    <div id="t-bkash" onclick="switchMethod('bkash')" class="toggle-btn active">Bkash</div>
                    <div id="t-nagad" onclick="switchMethod('nagad')" class="toggle-btn">Nagad</div>
                </div>

                <div class="mx-4 mt-8 p-6 bg-slate-50 rounded-[35px] border-2 border-dashed border-slate-200 flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <img src="apklogo.jpg" class="w-10 h-10 rounded-full shadow-sm" onerror="this.src='https://cdn-icons-png.flaticon.com/512/217/217853.png'">
                        <div class="text-left">
                            <p class="text-[10px] font-bold text-slate-400">PAYMENT AMOUNT</p>
                            <p class="text-2xl font-black">‡ß≥40</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="gateway-body" class="gateway-footer text-white">
                <h3 class="text-center font-bold text-lg mb-6">‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡¶ú‡ßá‡¶ï‡¶∂‡¶® ‡¶Ü‡¶á‡¶°‡¶ø ‡¶¶‡¶ø‡¶®</h3>
                <input type="text" id="trx-id-input" placeholder="‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡¶ú‡ßá‡¶ï‡¶∂‡¶® ‡¶Ü‡¶á‡¶°‡¶ø" class="w-full p-5 rounded-2xl text-slate-800 text-center font-bold text-xl outline-none shadow-inner">

                <div class="mt-10 space-y-4 px-2">
                    <div class="flex gap-4"><div class="w-6 h-6 rounded-full bg-white/20 flex items-center justify-center shrink-0">1</div><p id="inst-1" class="text-sm font-medium"></p></div>
                    <div class="flex gap-4"><div class="w-6 h-6 rounded-full bg-white/20 flex items-center justify-center shrink-0">2</div><p class="text-sm font-medium">"Send Money" -‡¶è ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p></div>
                    <div class="flex gap-4"><div class="w-6 h-6 rounded-full bg-white/20 flex items-center justify-center shrink-0">3</div><p class="text-sm font-medium">‡¶™‡ßç‡¶∞‡¶æ‡¶™‡¶ï ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶è‡¶á ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞‡¶ü‡¶ø ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡¶É</p></div>
                    
                    <div class="bg-black/20 p-4 rounded-2xl flex justify-between items-center">
                        <span id="target-number" class="text-2xl font-black tracking-tighter text-yellow-300">01804749569</span>
                        <button onclick="copyNumber()" class="bg-white/20 px-4 py-2 rounded-xl text-xs font-bold uppercase">Copy</button>
                    </div>
                </div>

                <button onclick="verifyPayment()" class="w-full bg-white text-slate-900 py-5 rounded-[25px] font-black text-xl mt-10 shadow-2xl active:scale-95 transition">VERIFY PAYMENT</button>
            </div>
        </div>
    </main>

    <!-- Navigation -->
    <nav class="bottom-nav" id="main-nav">
        <button onclick="navigate('home')" class="nav-item active" id="nav-home"><i class="fas fa-home"></i><span>Home</span></button>
        <button onclick="navigate('email')" class="nav-item" id="nav-email"><i class="fas fa-at"></i><span>Emails</span></button>
        <button onclick="navigate('vpn')" class="nav-item" id="nav-vpn"><i class="fas fa-shield-halved"></i><span>VPN</span></button>
        <button onclick="navigate('wallet')" class="nav-item" id="nav-wallet"><i class="fas fa-wallet"></i><span>Wallet</span></button>
        <button onclick="navigate('admin')" class="nav-item hidden" id="nav-admin"><i class="fas fa-user-gear text-red-500"></i><span>Admin</span></button>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // --- CONFIGURATION ---
        const ADMIN_ID = 6703675335;
        const BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"; // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßã‡¶ü ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶¶‡¶ø‡¶®
        const CHANNEL_ID = "@psisjdn"; // ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ
        
        let userBalance = 500.00;
        let products = [
            { id: 1, name: "NordVPN 1 Year", price: 250, stock: 12, cat: 'vpn', img: 'https://www.wizcase.com/wp-content/uploads/2022/03/NordVPN-Logo.png', desc: 'Secure encryption, 5000+ servers, and no-logs policy.' },
            { id: 2, name: "ExpressVPN Premium", price: 350, stock: 5, cat: 'vpn', img: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/ExpressVPN_logo.svg/1200px-ExpressVPN_logo.svg.png', desc: 'The fastest VPN on the market. High bandwidth for streaming.' },
            { id: 3, name: "Surfshark VPN", price: 180, stock: 20, cat: 'vpn', img: 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/Surfshark_logo.svg/1200px-Surfshark_logo.svg.png', desc: 'Unlimited devices connection. Best value for money.' },
            { id: 4, name: "CyberGhost VPN", price: 220, stock: 8, cat: 'vpn', img: 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/1e/CyberGhost_VPN_logo.svg/1200px-CyberGhost_VPN_logo.svg.png', desc: 'Optimized servers for Netflix and Torrenting.' }
        ];

        function navigate(page) {
            document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
            document.getElementById('view-' + page).classList.remove('hidden');
            
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            const activeNav = document.getElementById('nav-' + (page === 'vpn-details' ? 'vpn' : page));
            if(activeNav) activeNav.classList.add('active');

            if(page === 'home') renderGrid('product-grid', products.slice(0,4));
            if(page === 'vpn') renderVpnList();
            if(page === 'admin') renderAdmin();
        }

        // --- VPN List Rendering ---
        function renderVpnList() {
            const container = document.getElementById('vpn-grid');
            container.innerHTML = '';
            products.filter(p => p.cat === 'vpn').forEach(p => {
                container.innerHTML += `
                    <div onclick="openVpnDetails(${p.id})" class="vpn-card p-4 flex items-center gap-4">
                        <img src="${p.img}" class="w-16 h-16 object-contain">
                        <div class="flex-1">
                            <h3 class="font-bold text-slate-800">${p.name}</h3>
                            <p class="text-xs text-slate-400 font-medium">In Stock: ${p.stock}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-blue-600 font-black">‡ß≥${p.price}</p>
                            <span class="text-[10px] bg-blue-50 text-blue-500 px-2 py-1 rounded-lg font-bold">VIEW</span>
                        </div>
                    </div>
                `;
            });
        }

        function openVpnDetails(id) {
            const p = products.find(i => i.id === id);
            const content = document.getElementById('vpn-details-content');
            content.innerHTML = `
                <div class="h-64 bg-slate-50 flex items-center justify-center p-10">
                    <img src="${p.img}" class="max-h-full">
                </div>
                <div class="p-6">
                    <h2 class="text-3xl font-black text-slate-900">${p.name}</h2>
                    <div class="flex items-center gap-2 mt-2">
                        <span class="bg-green-100 text-green-600 px-3 py-1 rounded-full text-xs font-bold uppercase">In Stock</span>
                        <p class="text-slate-400 font-bold text-xs">${p.stock} Units Available</p>
                    </div>
                    <p class="mt-6 text-slate-500 leading-relaxed font-medium">${p.desc}</p>
                    
                    <div class="mt-10 p-6 bg-slate-900 rounded-[30px] flex justify-between items-center text-white">
                        <div>
                            <p class="text-[10px] font-bold opacity-50 uppercase">Instant Access</p>
                            <p class="text-3xl font-black">‡ß≥${p.price}</p>
                        </div>
                        <button onclick="requestPurchase('VPN', '${p.name}', ${p.price})" class="bg-blue-600 px-8 py-4 rounded-2xl font-black shadow-lg">ORDER NOW</button>
                    </div>
                </div>
            `;
            
            // Similar Products
            const similar = document.getElementById('similar-products');
            similar.innerHTML = '';
            products.filter(item => item.id !== id).forEach(item => {
                similar.innerHTML += `
                    <div onclick="openVpnDetails(${item.id})" class="min-w-[140px] bg-slate-50 p-4 rounded-2xl text-center border border-slate-100">
                        <img src="${item.img}" class="h-12 mx-auto mb-2 object-contain">
                        <p class="text-[10px] font-bold truncate">${item.name}</p>
                        <p class="text-xs font-black text-blue-600">‡ß≥${item.price}</p>
                    </div>
                `;
            });

            navigate('vpn-details');
        }

        // --- Telegram Sending Logic ---
        async function sendToTelegram(message) {
            // ‡¶è‡¶á ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡¶ü‡¶ø ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶¨‡ßá
            // ‡¶¶‡ßç‡¶∞‡¶∑‡ßç‡¶ü‡¶¨‡ßç‡¶Ø: ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø Bot Token ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶∞‡¶ø‡¶ü‡¶ø ‡¶∞‡¶ø‡¶∏‡ßç‡¶ï ‡¶•‡¶æ‡¶ï‡ßá, ‡¶∞‡¶ø‡ßü‡ßá‡¶≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßá ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶è‡¶®‡ßç‡¶° ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶≠‡¶æ‡¶≤‡ßã‡•§
            const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHANNEL_ID}&text=${encodeURIComponent(message)}`;
            try {
                await fetch(url);
                return true;
            } catch(e) {
                console.log(e);
                return false;
            }
        }

        function requestPurchase(cat, name, price) {
            if(userBalance < price) {
                tg.showAlert("Insufficient Balance! Please add money.");
                return navigate('wallet');
            }

            tg.showConfirm(`Confirm Buying ${name} for ‡ß≥${price}?`, async (ok) => {
                if(ok) {
                    const user = tg.initDataUnsafe.user || { first_name: "Customer", id: "000" };
                    const msg = `üõçÔ∏è NEW ORDER\n\nüë§ User: ${user.first_name} (${user.id})\nüì¶ Item: ${name}\nüí∞ Price: ‡ß≥${price}\nüìÇ Cat: ${cat}\nüïí Date: ${new Date().toLocaleString()}`;
                    
                    // Simulate processing
                    tg.showProgress(true);
                    await sendToTelegram(msg);
                    userBalance -= price;
                    updateUI();
                    tg.showProgress(false);
                    tg.showAlert("Purchase Request Sent! Our agent will contact you via Bot.");
                }
            });
        }

        // --- Payment Logic ---
        function openGateway(method) {
            document.getElementById('view-gateway').classList.remove('hidden');
            switchMethod(method);
        }

        function closeGateway() { document.getElementById('view-gateway').classList.add('hidden'); }

        function switchMethod(method) {
            const body = document.getElementById('gateway-body');
            const logo = document.getElementById('gateway-logo');
            const b = document.getElementById('t-bkash');
            const n = document.getElementById('t-nagad');

            b.classList.remove('active'); n.classList.remove('active');

            if(method === 'bkash') {
                body.style.backgroundColor = "var(--bkash)";
                logo.src = "bkash.jpg"; // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶´‡¶æ‡¶á‡¶≤
                b.classList.add('active');
                document.getElementById('target-number').innerText = "01804749569";
                document.getElementById('inst-1').innerText = "*247# ‡¶°‡¶æ‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ Bkash ‡¶Æ‡ßá‡¶®‡ßÅ‡¶§‡ßá ‡¶Ø‡¶æ‡¶®‡•§";
            } else {
                body.style.backgroundColor = "var(--nagad)";
                logo.src = "nagad.jpg"; // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶´‡¶æ‡¶á‡¶≤
                n.classList.add('active');
                document.getElementById('target-number').innerText = "01886313023";
                document.getElementById('inst-1').innerText = "*247# ‡¶°‡¶æ‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ Nagad ‡¶Æ‡ßá‡¶®‡ßÅ‡¶§‡ßá ‡¶Ø‡¶æ‡¶®‡•§";
            }
        }

        async function verifyPayment() {
            const trx = document.getElementById('trx-id-input').value;
            if(!trx) return tg.showAlert("Please enter Transaction ID!");

            const user = tg.initDataUnsafe.user || { first_name: "Customer", id: "0" };
            const msg = `üí∞ NEW DEPOSIT REQUEST\n\nüë§ User: ${user.first_name}\nüÜî User ID: ${user.id}\nüí≥ TrxID: ${trx}\nüí∞ Amount: ‡ß≥40\nüïí Time: ${new Date().toLocaleString()}`;
            
            tg.showProgress(true);
            await sendToTelegram(msg);
            tg.showProgress(false);
            tg.showAlert("Verification Request Sent! We will update your balance within 30 minutes.");
            closeGateway();
        }

        // --- Initial Load ---
        function updateUI() {
            document.getElementById('balance-top').innerText = `‡ß≥${userBalance.toFixed(2)}`;
            document.getElementById('wallet-balance-val').innerText = userBalance.toFixed(2);
        }

        function init() {
            const user = tg.initDataUnsafe.user || { first_name: "Customer", id: 0 };
            document.getElementById('user-display-name').innerText = user.first_name;
            if(user.photo_url) document.getElementById('profile-pic').src = user.photo_url;
            if(user.id == ADMIN_ID) document.getElementById('nav-admin').classList.remove('hidden');
            updateUI();
            navigate('home');
        }

        init();
    </script>
</body>
</html>
